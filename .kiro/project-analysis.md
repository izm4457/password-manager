# プロジェクト分析レポート

**生成日**: 2025年11月25日

## プロジェクト概要

**パスワードマネージャー** - Tauri + React で構築されたデスクトップアプリケーション

### 技術スタック

- **フロントエンド**: React 19.2.0 + Vite 7.2.4 + Tailwind CSS 4.1.17
- **バックエンド**: Tauri 2.9.2 (Rust)
- **暗号化**: AES-256-GCM + Argon2
- **その他**: UUID生成、Tauri Dialog Plugin

### 依存関係

#### フロントエンド主要パッケージ
- `react` & `react-dom`: ^19.2.0
- `@tauri-apps/api`: ^2.9.0
- `@tauri-apps/plugin-dialog`: ^2.4.2
- `uuid`: ^13.0.0
- `tailwindcss`: ^4.1.17

#### バックエンド主要クレート
- `tauri`: 2.9.2
- `aes-gcm`: 0.10.3 (AES-256-GCM暗号化)
- `argon2`: 0.5.3 (パスワード派生関数)
- `base64`: 0.22.1
- `rand`: 0.9.2
- `serde` & `serde_json`: 1.0

## 機能一覧

### 1. 初回セットアップ (`Setup.jsx`)
- **新規データベース作成**
  - ファイル保存ダイアログで保存場所を選択
  - マスターパスワードの設定（4文字以上）
  - 空の暗号化データベースを作成
  
- **既存データベースを開く**
  - ファイル選択ダイアログで既存の.jsonファイルを選択
  - マスターパスワードで復号化を試行
  - 成功時にconfig.jsonに保存場所を記録

### 2. 認証システム (`Login.jsx`)
- マスターパスワードによるログイン
- パスワード検証（復号化の成功/失敗で判定）
- エラーハンドリングとユーザーフィードバック

### 3. パスワード管理 (`Dashboard.jsx`)
- **一覧表示**
  - サービス名、ユーザー名を表示
  - パスワードは非表示（コピーボタンで取得）
  
- **検索機能**
  - サービス名またはユーザー名でリアルタイム検索
  - 大文字小文字を区別しない
  
- **コピー機能**
  - サービス名をコピー
  - ユーザー名をコピー
  - パスワードをコピー
  
- **CRUD操作**
  - 追加: モーダルで新規パスワード入力
  - 編集: 既存パスワードの更新
  - 削除: 確認モーダル付き削除

### 4. モーダルコンポーネント
- `PasswordModal`: パスワード追加/編集フォーム
- `ConfirmationModal`: 削除確認ダイアログ

## アーキテクチャ

### フロントエンド構成

```
src/
├── App.jsx                    # メインアプリケーションロジック
├── components/
│   ├── Setup.jsx             # 初回セットアップ画面
│   ├── Login.jsx             # ログイン画面
│   ├── Dashboard.jsx         # パスワード一覧・検索UI
│   ├── PasswordModal.jsx     # パスワード追加/編集モーダル
│   └── ConfirmationModal.jsx # 削除確認モーダル
```

**状態管理** (`App.jsx`):
- `isAuthenticated`: 認証状態
- `masterPassword`: マスターパスワード（メモリ内保持）
- `passwords`: パスワードリスト
- `isFirstRun`: 初回起動フラグ
- モーダル制御用の状態

### バックエンド構成

```
src-tauri/src/
├── lib.rs        # Tauriコマンド定義
└── crypto.rs     # 暗号化/復号化ロジック
```

**Tauriコマンド**:
1. `is_initialized()`: 初期化済みかチェック
2. `initialize_database(path, master_password)`: 新規データベース作成
3. `open_database(path, master_password)`: 既存データベースを開く
4. `save_passwords(data, master_password)`: パスワードを暗号化して保存
5. `load_passwords(master_password)`: パスワードを復号化して読み込み

## セキュリティ設計

### 暗号化方式

**AES-256-GCM** (Galois/Counter Mode):
- 認証付き暗号化（AEAD）
- 256ビット鍵長
- データの機密性と完全性を保証

**Argon2** (パスワード派生関数):
- メモリハード関数（ブルートフォース攻撃に強い）
- ランダムソルト生成
- マスターパスワードから32バイトの暗号化鍵を派生

### 暗号化データ構造

```json
{
  "ciphertext": "base64エンコードされた暗号文",
  "nonce": "base64エンコードされたノンス（12バイト）",
  "salt": "Argon2ソルト"
}
```

### データフロー

1. **保存時**:
   ```
   パスワードデータ(JSON)
   → Argon2(マスターパスワード + ソルト) → 暗号化鍵
   → AES-256-GCM暗号化
   → Base64エンコード
   → ファイルに保存
   ```

2. **読み込み時**:
   ```
   ファイルから読み込み
   → Base64デコード
   → Argon2(マスターパスワード + 保存されたソルト) → 暗号化鍵
   → AES-256-GCM復号化
   → パスワードデータ(JSON)
   ```

### セキュリティ特性

✅ **実装済み**:
- エンドツーエンド暗号化（ローカルのみ）
- マスターパスワードはメモリ内のみ保持
- ソルトとノンスのランダム生成
- 認証付き暗号化（改ざん検知）

⚠️ **考慮事項**:
- マスターパスワードの強度はユーザー依存（最低4文字）
- メモリ内のマスターパスワードは平文
- クリップボードにコピーされたパスワードは保護されない
- バックアップ機能なし（ファイル紛失時は復旧不可）

## ファイル構成

### 設定ファイル
- **アプリ設定**: `{app_data_dir}/config.json`
  ```json
  {
    "data_path": "/path/to/passwords.json"
  }
  ```

- **パスワードデータベース**: ユーザー指定の場所（例: `~/Documents/passwords.json`）
  - 暗号化されたJSON形式

### データモデル

**パスワードエントリ**:
```javascript
{
  id: "uuid-v4",
  service: "サービス名",
  username: "ユーザー名",
  password: "パスワード"
}
```

## UI/UX設計

### デザインシステム
- **カラースキーム**: ダークモード（グレー900ベース）
- **アクセントカラー**: ブルー（400, 500, 600）
- **フォント**: システムデフォルト
- **レイアウト**: 中央寄せ、最大幅4xl

### インタラクション
- ホバー時にアクションボタン表示（Dashboard）
- トランジション効果（色変更、透明度）
- ローディング状態の表示
- エラーメッセージの表示

## 改善提案

### セキュリティ強化
1. マスターパスワード強度チェック（大文字、数字、記号の要求）
2. パスワード生成機能
3. 自動ロック機能（一定時間後）
4. クリップボード自動クリア
5. 二要素認証の検討

### 機能追加
1. カテゴリ/タグ機能
2. お気に入り機能
3. パスワード履歴
4. インポート/エクスポート機能
5. バックアップ機能
6. パスワード強度インジケーター
7. 重複パスワード検出
8. 漏洩パスワードチェック（Have I Been Pwned API）

### UX改善
1. キーボードショートカット
2. ダークモード/ライトモード切り替え
3. 並び替え機能（名前順、作成日順など）
4. 一括操作（複数選択、一括削除）
5. 最近使用したパスワード
6. 検索履歴

### 技術的改善
1. TypeScriptへの移行
2. 状態管理ライブラリ（Zustand, Jotai等）
3. フォームバリデーション強化
4. エラーバウンダリ
5. ユニットテスト・E2Eテスト
6. ログ機能の強化
7. 自動更新機能

## 開発コマンド

```bash
# 開発サーバー起動
npm run dev

# ビルド
npm run build

# Lintチェック
npm run lint

# Tauriアプリ起動
npm run tauri dev

# Tauriアプリビルド
npm run tauri build
```

## まとめ

このプロジェクトは、基本的なパスワードマネージャーとして必要な機能を備えています。暗号化の実装は堅牢で、Argon2とAES-256-GCMの組み合わせは業界標準です。

今後の開発では、セキュリティ強化（自動ロック、パスワード生成）や利便性向上（カテゴリ、バックアップ）に注力することで、より実用的なアプリケーションに成長できます。
